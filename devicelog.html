<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Device Log</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            padding: 20px;
            background-color: #f8f9fa;
        }
        h1 {
            text-align: center;
            color: #343a40;
        }
        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border: 1px solid #dee2e6;
            background-color: #ffffff;
            margin: 0 5px;
            border-radius: 5px;
        }
        .tab.active {
            background-color: #007bff;
            color: white;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        textarea, input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            font-size: 16px;
            border: 1px solid #ced4da;
            border-radius: 5px;
        }
        button {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        .log {
            margin-top: 20px;
            padding: 15px;
            background-color: #e9ecef;
            border-radius: 5px;
            border: 1px solid #dee2e6;
        }
        .log ul {
            list-style-type: none;
            padding: 0;
        }
        .log li {
            background: #ffffff;
            margin: 5px 0;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ced4da;
        }
    </style>
</head>
<body>
    <h1>Device Log</h1>

    <div class="tabs">
        <div class="tab active" onclick="showTab('scanner')">Scanner Input</div>
        <div class="tab" onclick="showTab('manual')">Manual Input</div>
    </div>

    <div id="scanner" class="tab-content active">
        <label for="scanner-input-1">Input 1 (Device or Employee):</label>
        <input type="text" id="scanner-input-1" placeholder="Scan or enter device/employee" oninput="delayFocus('scanner-input-2')">
        <label for="scanner-input-2">Input 2 (Device or Employee):</label>
        <input type="text" id="scanner-input-2" placeholder="Scan or enter device/employee" oninput="delayLog()">
    </div>

    <div id="manual" class="tab-content">
        <label for="manual-device">Enter Device ID:</label>
        <input type="text" id="manual-device" placeholder="Enter Device ID (e.g., AATC405593)">
        <label for="manual-employee">Enter Employee Number:</label>
        <input type="text" id="manual-employee" placeholder="Enter Employee Number (e.g., 265769)">
        <button onclick="formatAndLogData('manual')">Format and Log</button>
    </div>

    <div class="log" id="log">
        <strong>Formatted Output Log:</strong>
        <ul id="log-list"></ul>
        <button onclick="copyLog()">Copy All</button>
    </div>

    <script>
        let focusTimeout, logTimeout;

        function showTab(tabId) {
            // Hide all tab content
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));

            // Deactivate all tabs
            const tabButtons = document.querySelectorAll('.tab');
            tabButtons.forEach(button => button.classList.remove('active'));

            // Show the selected tab content and activate the tab
            document.getElementById(tabId).classList.add('active');
            document.querySelector(`.tab.${tabId === 'scanner' ? 'active' : ''}`).classList.add('active');
        }

        function delayFocus(nextInputId) {
            clearTimeout(focusTimeout);
            const input1 = document.getElementById('scanner-input-1').value.trim();
            if (input1) {
                focusTimeout = setTimeout(() => {
                    document.getElementById(nextInputId).focus();
                }, 1000); // Delay of 1 second
            }
        }

        function delayLog() {
            clearTimeout(logTimeout);
            const input1 = document.getElementById('scanner-input-1').value.trim();
            const input2 = document.getElementById('scanner-input-2').value.trim();

            if (input1 && input2) {
                logTimeout = setTimeout(() => {
                    autoLogScanner(input1, input2);
                }, 1000); // Delay of 1 second
            }
        }

        function autoLogScanner(input1, input2) {
            // Determine which is device and which is employee
            const isEmployee = value => /\d{6,}/.test(value); // Assume employee has a long numeric part
            const deviceInput = isEmployee(input1) ? input2 : input1;
            const employeeInput = isEmployee(input1) ? input1 : input2;

            // Format and log the data
            formatAndLogData('scanner', deviceInput, employeeInput);

            // Clear inputs for the next scan
            document.getElementById('scanner-input-1').value = '';
            document.getElementById('scanner-input-2').value = '';

            // Return focus to the device info field
            document.getElementById('scanner-input-1').focus();
        }

        function formatAndLogData(source, device = '', employee = '') {
            if (source === 'manual') {
                device = document.getElementById('manual-device').value.trim();
                employee = document.getElementById('manual-employee').value.trim();
            }

            // Validate inputs
            if (!device || !employee) {
                alert('Please provide valid inputs for both fields!');
                return;
            }

            // Format data
            const formattedData = `${device}/${employee}`;

            // Log formatted data
            const logList = document.getElementById('log-list');
            const newLogItem = document.createElement('li');
            newLogItem.textContent = formattedData;
            logList.appendChild(newLogItem);

            // Clear inputs for manual
            if (source === 'manual') {
                document.getElementById('manual-device').value = '';
                document.getElementById('manual-employee').value = '';
            }
        }

        function copyLog() {
            // Get all log items
            const logItems = document.querySelectorAll('#log-list li');
            let logText = '';
            logItems.forEach(item => {
                logText += item.textContent + '\n';
            });

            // Copy to clipboard
            navigator.clipboard.writeText(logText).then(() => {
                alert('Log copied to clipboard!');
            }).catch(err => {
                alert('Failed to copy log. Please try again.');
            });
        }
    </script>
</body>
</html>
